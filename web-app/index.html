<head>
	<meta charset="utf-8" />
	<title>AR</title>
	<meta name="description" content="A recreation of https://zenodo.org/record/3672860#.X39mSHhKjly" />
	<link rel="icon" href="/favicon.ico" />

	<!-- css -->
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" type="text/css" href="/index.css" />

	<!--  Include A-Frame and AR.js  -->
	<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
	<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

	<!--  Meta for apple's picky mobile devices  -->
	<meta name="apple-mobile-web-app-capable" content="yes" />

	<!-- import axios -->
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

	<!-- Google Analytics -->
	<!-- <script>
		// init ga
		;(function (i, s, o, g, r, a, m) {
			i['GoogleAnalyticsObject'] = r
			;(i[r] =
				i[r] ||
				function () {
					;(i[r].q = i[r].q || []).push(arguments)
				}),
				(i[r].l = 1 * new Date())
			;(a = s.createElement(o)), (m = s.getElementsByTagName(o)[0])
			a.async = 1
			a.src = g
			m.parentNode.insertBefore(a, m)
		})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga')

		// out code
		ga('create', 'UA-XXXXX-Y', 'auto')
		ga('send', 'pageview')
	</script> -->
	<!-- End Google Analytics -->
</head>

<body>
	<script>
		// Vidhandler toggles visibility of live-streamed video
		AFRAME.registerComponent('vidhandler', {
			init: function () {
				this.toggle = false
				this.vid = document.querySelector('video')
			},
			tick: function () {
				if (this.el.object3D.visible === true) {
					if (!this.toggle) {
						this.toggle = true
						this.vid.style.visibility = 'visible'
						// this.vid.play();
					}
				} else {
					if (this.toggle) {
						this.toggle = false
						// this.vid.pause();
						this.vid.style.visibility = 'hidden'
					}
				}
			},
		})

		window.onload = () => {
			// Hide livestream video initially
			document.querySelector('video').style.visibility = 'hidden'
		}
	</script>

	<video
		id="video"
		preload="auto"
		class="video-js"
		webkit-playsinline
		playsinline
		autoplay
		loop
		crossorigin="anonymous"
		muted
	>
		<!--  Source is just a demo bloomberg (don't judge) livestream for now  -->
		<source
			src="https://liveprodeuwest.akamaized.net/eu1/Channel-EUTVqvs-AWS-ireland-1/Source-EUTVqvs-700-1_live.m3u8"
			type="application/x-mpegURL"
		/>
	</video>

	<a-scene embedded arjs>
		<a-marker preset="hiro" vidhandler>
			<!-- This would work if Apple wasn't stupid and broke iOS 14 -->
			<!-- <a-plane position='0 0 0' rotation="-90 0 0" width="4" height="4" material='transparent:true;opacity: 0.7;src:#video'></a-plane> -->
			<!-- <a-video src="#video" position='0 0 0' width="3" height="1" rotation="-90 0 0"></a-video> -->
		</a-marker>
		<a-entity camera></a-entity>
	</a-scene>

	<!-- buttons for motion -->
	<button id="gyroButton"></button>
	<button id="accelButton"></button>
	<script src="sensors.js"></script>
</body>
